# zkdex：基于 zk-rollup 的去中心化兑换协议

## zkdex 简介

以太坊网络在启动后的数年中，取得了巨大的成就，同时也遇到了速度慢和交易费高等问题。网络中计算、存储等资源紧缺，制约了以太坊网络的进一步发展，由此诞生了链上（Layer1） 和 链下（Layer2）扩容技术。

zkdex 是星辰实验室在以太坊 Layer2 扩容领域的第一个产品，使用 Plonk 证明系统来实现将大部分的计算、存储都放到链下，从而实现了交易的秒级确认、交易费低于 Layer1 兑换协议的百分之一。由于数学和密码学的保证，又可以实现跟 Layer1 同等的资金安全性。

## 产品特性

1）完整的 AMM 业务模型

我们在二层实现了 AMM 算法，包含了资金池管理、兑换等功能。

2）二层去中心化挖矿

为了满足 LP 持有者的挖矿需求，保证其二层的沉浸式体验，我们在二层的执行环境和电路证明环境实现了流动性挖矿功能。参与挖矿和领取收益，均在二层秒级进行。免去了提现到一层的交易费消耗和等待时间。

3）二层交易秒级确认

得益于二层的特性，所有的二层交易，可以实现秒级确认。

4）极速提币体验

通过自研零知识证明硬件加速方案和证明集群调度系统，实现了规模的区块并行证明和聚合验证，可实现最小十分钟级别的提币到账时间。

## 为什么又做一个 zk-rollup 独立应用（网络）

1. zk-rollup 具有独特优势-交易最终化速度

零知识证明机制，可以保证交易可以快速得到一层的确认，无需漫长的挑战期。

2. 已有zk-rollup项目，性能与扩展性依然有提升空间（证明生成速度、数据规模）

在观察现有的开源系统之后，我们发现 zk-rollup 的系统在未优化之前，实际性能不高。在证明速度、数据扩展性上存在瓶颈，无法支撑百万级的日交易量。我们在提高扩展性上做了大量的工作，优化了上述瓶颈点。

3. zkevm 尚未落地、远未完善（指令集完备、Solidity 无缝迁移、性能）

zkevm 将有望会推动 zk-rollup 成为终极的扩容方案。目前有数个团队提出了 zkevm 的实现方案，还没有具体落地。在证明环境中实现完备的EVM指令集有较大挑战，大规模部署的可组合应用带来的证明效率问题也有待解决。

4. 为 Layer2 环境设计的应用，将会带来更多的特性

以太坊交易执行，本质是 Solidity 编译后的 Bytecode 在 EVM 中解析执行。计算和存储指令的执行都会产生 gas 消耗（存储指令尤甚）。为了减少 gas 消耗，开发者社区使用了各种魔法。独立的 zk-rollup 系统部署到链下，在执行业务交易时，可以使用更大量计算和存储资源，最终提交到一层的只是交易信息参数信息和合法性证明。把握这个特性，我们将可以在二层创造用户体验更好的产品。

## 未来

当前可以看到，基于 rollup 的 layer2 扩容系统有了较好的落地，以太坊生态也将会使用 ETH2.0+ rollup 的扩容路线。如果考虑让数以千万的用户使用基于 rollup 的以太坊网络，下面的问题将有待解决：
```
Rollup用户、开发者生态工具
Rollup 内应用可组合性
Solidity智能合约&EVM兼容性
跨 Rollup 互操作、资金效率
大规模零知识证明网络
突破以太坊区块容量的制约
```
以上也将是我们的努力方向。

## 感谢行业的先行者
自 zcash 上线以来，零知识证明与区块链的结合飞速发展。

zk-snarks、zk-starks等证明系统，libsnark、bellman 等工程库，以及大量的业务实践，使得我们这个项目得以成为可能。

在这里感谢行业先行者：zcash、matter-labs、starkware、aztec、hermez、loopring、zkswap等团队为行业做出的贡献。